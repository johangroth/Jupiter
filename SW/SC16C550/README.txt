Code is copied from 6502.org (http://forum.6502.org/viewtopic.php?f=2&t=5037)
